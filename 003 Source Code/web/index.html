<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <title>auth-min — 로그인/로그아웃 데모</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- 파비콘 404 방지 -->
  <link rel="icon" href="data:,">
  <link rel="stylesheet" href="./css/styles.css" />
</head>

<body>
  <main class="container">
    <h1>auth-min</h1>
    <p class="hint">정적 페이지와 API를 같은 서버(예: FastAPI)에서 서빙 중이면 CORS 걱정 없이 동작합니다.</p>

    <!-- 세션 상태 -->
    <section class="card" id="statusCard">
      <h2>세션 상태</h2>
      <div id="meBox" class="mono">확인 중...</div>
      <div class="row gap" id="logoutBox">
        <button id="btnRefresh" class="btn">상태 새로고침</button>
        <button id="btnLogout" class="btn btn-outline">로그아웃</button>
      </div>
      <div id="outMsg" class="mono small"></div>
    </section>

    <!-- 로그인 박스 -->
    <section class="card" id="loginBox">
      <h2>로그인</h2>
      <label for="email">이메일</label>
      <input id="email" type="email" placeholder="you@example.com" required />

      <label for="password">비밀번호</label>
      <input id="password" type="password" placeholder="••••••••••" required />

      <button id="btnLogin" class="btn btn-primary">로그인</button>
      <div id="loginMsg" class="mono small"></div>

      <!-- (2차) OTP 입력 단계 -->
      <div id="mfaBox" style="display:none; margin-top:16px;">
        <h3>OTP 인증</h3>
        <label for="otpCode">앱의 6자리 코드</label>
        <input id="otpCode" inputmode="numeric" maxlength="6" placeholder="123456" />
        <button id="btnOtp" class="btn">확인</button>
        <div id="mfaMsg" class="mono small"></div>
      </div>
    </section>

    <!-- 회원가입 박스 -->
    <section class="card" id="registerBox">
      <h2>회원가입</h2>
      <label for="regEmail">이메일</label>
      <input id="regEmail" type="email" placeholder="you@example.com" required />
      <label for="regPass">비밀번호 (최소 10자)</label>
      <input id="regPass" type="password" placeholder="••••••••••" required />
      <div class="row gap">
        <button id="btnRegister" class="btn">가입(코드 전송)</button>
      </div>
      <div id="regMsg" class="mono small" style="margin-top:8px;"></div>

      <!-- 이메일 코드 확인 -->
      <div style="margin-top:16px;">
        <h3>이메일 인증</h3>
        <label for="emailCode">이메일 인증코드(6자리)</label>
        <input id="emailCode" inputmode="numeric" maxlength="6" placeholder="123456" />
        <button id="btnVerifyEmailCode" class="btn">인증코드 확인</button>
        <div id="emailCodeMsg" class="mono small"></div>
      </div>

      <!-- 가입 직후: OTP 등록 안내/QR 표시 -->
      <section class="card" id="totpRegBox" style="display:none">
        <h2>OTP(TOTP) 등록</h2>
        <p class="small">QR을 스캔하고 회원가입을 완료하세요.</p>
        <div id="totpRegInfo" class="mono small"></div>
        <div id="qrBoxReg" style="margin:8px 0;"></div>
        <label for="totpActivateCode">앱에 표시된 코드</label>
        <input id="totpActivateCode" inputmode="numeric" maxlength="6" placeholder="123456" />
        <button id="btnActivateTotp" type="button" class="btn btn-primary">가입 완료</button>
        <div id="totpActivateMsg" class="mono small"></div>
      </section>
    </section>
  </main>

  <!-- QRCode 라이브러리(app.js보다 먼저 로드되어야 함) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
  <script src="./js/app.js"></script>
</body>

</html>